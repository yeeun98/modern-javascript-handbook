## 실행 컨텍스트란 ?
~~~
💡 실행 컨텍스트란, 식별자(변수, 함수, 클래스 등의 이름)를 등록하고 관리하는 스코프와 코드 실행 순서 관리를 구현한 내부 메커니즘으로,
모든 코드를 실행 컨텍스트를 통해 실행되고 관리된다.

→ 소스코드를 실행하는데 필요한 환경을 제공하고 코드의 실행 결과를 관리하는 영역이다.
~~~
> 자바스크립트는 소스코드를 ‘**소스코드의 평가**’와 ‘**소스코드의 실행**’ 과정으로 나누어 처리한다.

- **소스코드의 평가**  
    실행 컨텍스트를 생성하고 변수, 함수 등의 선언문만 먼저 실행하여 생성된 변수나 함수 식별자를 키로 실행 컨텍스트를 관리하는 스코프에 등록한다.
    
- **소스코드의 실행**  
    소스코드 평가 과정이 끝나면, 런타임이 시작되는데 이 때 소스코드 실행에 필요한 정보 (변수나 함수의 참조)를 실행 컨텍스트가 관리하는 스코프에서 탐색하여 값을 가져온다.
    
### 실행 컨텍스트 스택

```jsx
const x = 1;

function foo() {
  const y = 2;
  
  function bar () {
    const z = 3;
    console.log(x+y+z);
  }

  bar();
}

foo(); // 6
```

![58DBC330-C349-49EF-9BA4-2892C3AC6262](https://github.com/user-attachments/assets/41f8da42-f66e-457b-bb67-79ab74394615)

1. 전역 코드의 평가와 실행  
  : 전역 변수 x와 전역 함수 foo가 전역 실행 컨텍스트에 등록된다.  
  : 이후 전역 코드가 실행되어 전역 변수 x에 값이 할당되고, 전역 함수 foo가 호출되어 실행된다.
    
3. foo 함수 코드의 평가와 실행
    코드 제어권이 foo 함수 내부로 이동한다. 이때 함수의 지역 변수인 y와 중첩 함수 bar가 foo 함수 실행 컨텍스트에 등록된다. 이후 foo 함수 코드가 실행되고 bar 함수가 호출된다.
    
4. bar 함수 코드의 평가와 실행
    코드 제어권이 bar 함수 내부로 이동한다. 이때 함수의 지역 변수인 z가 bar 함수 실행 컨텍스트에 등록된다. 이후 bar 함수 코드가 실행되고 console.log 메서드를 호출한 이후 bar 함수는 종료된다.
    
5. foo 함수 코드로 복귀
    다시 코드 제어권이 foo 함수 내부로 이동한다. 이 때 bar 함수는 실행컨텍스트 스택에서 제거된다. foo 함수에 더이상 실행할 코드가 없으므로 foo 함수도 종료된다.
    
6. 전역 코드로 복귀
    다시 코드 제어권이 전역 코드로 이동한다. 이 때 foo 함수는 실행컨텍스트 스택에서 제거된다. 더이상 실행할 코드가 없으므로 전역 실행 컨텍스트도 실행 컨텍스트 스택에서 팝되어 실행 컨텍스트에는 아무것도 남지 않게 된다.
    

⇒ 이처럼 실행 컨텍스트는 코드의 실행 순서를 관리한다. 실행 컨텍스트 스택의 최상단에 존재하는 실행 컨텍스트는 언제나 현재 실행 중인 코드의 실행 컨텍스트이다.

<br/>

## 렉시컬 환경

렉시컬 환경은 환경 레코드 / 외부 렉시컬 환경에 대한 참조 라는 두 개의 컴포넌트로 구성된다.

![D764A561-E7B7-4085-8DFA-8ABCFA8D28D3](https://github.com/user-attachments/assets/ec5f9bac-0d8a-4c51-9e4c-fb7f6149f7ef)

- 환경 레코드
  스코프에 포함된 식별자를 등록하고 등록된 식별자에 바인딩된 값을 관리하는 저장소다.  
  환경 레코드는 소스코드의 타입에 따라 관리하는 내용에 차이가 있다.  
    
- 외부 렉시컬 환경에 대한 참조
  외부 렉시컬 환경에 대한 참조는 상위 스코프를 가리킨다.
  이때 상위 스코프란 외부 렉시컬 환경, 즉 해당 실행 컨텍스트를 생성한 소스코드를 포함하는 상위 코드의 렉시컬 환경을 말한다.
  외부 렉시컬 환경에 대한 참조를 통해 단방향 링크드 리스트인 스코프 체인을 구현한다.

<br/>

## 실행 컨텍스트의 생성과 식별자 검색 과정

```jsx
var x = 1;
const y = 2;

function foo(a) {
  var x = 3;
  const y = 4;
  
  function bar (b) {
    const z = 5;
    console.log(a + b + x + y + z);
  }

  bar(10);
}

foo(20);
```

![전역 환경 레코드의 선언적 환경 레코드](https://github.com/user-attachments/assets/4ae61b70-86b5-408c-94b7-01676ea2c795)
전역 환경 레코드의 선언적 환경 레코드

![foo 함수 코드의 실행](https://github.com/user-attachments/assets/d11b6461-4704-47e8-a14e-de8b90f07633)
foo 함수 코드의 실행

![bar 함수 실행 컨텍스트와 렉시컬 환경](https://github.com/user-attachments/assets/3d367ab3-a9cd-4042-909d-2d046e7dc16c)
bar 함수 실행 컨텍스트와 렉시컬 환경
